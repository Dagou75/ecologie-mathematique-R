<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Analyse et modélisation d’agroécosystèmes</title>
  <meta name="description" content="Ce cours a pour objectif de former les étudiants gradués en génie agroenvironnemental, génie civil, génie écologique, agronomie, biologie, foresterie et écologie en analyse et modélisation de systèmes vivants. Les sujets traités sont l’introduction au langage de programmation R, l’analyse statistique descriptive, la visualisation, la modélisation inférentielle, prédictive et déterministe.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Analyse et modélisation d’agroécosystèmes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Ce cours a pour objectif de former les étudiants gradués en génie agroenvironnemental, génie civil, génie écologique, agronomie, biologie, foresterie et écologie en analyse et modélisation de systèmes vivants. Les sujets traités sont l’introduction au langage de programmation R, l’analyse statistique descriptive, la visualisation, la modélisation inférentielle, prédictive et déterministe." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Analyse et modélisation d’agroécosystèmes" />
  
  <meta name="twitter:description" content="Ce cours a pour objectif de former les étudiants gradués en génie agroenvironnemental, génie civil, génie écologique, agronomie, biologie, foresterie et écologie en analyse et modélisation de systèmes vivants. Les sujets traités sont l’introduction au langage de programmation R, l’analyse statistique descriptive, la visualisation, la modélisation inférentielle, prédictive et déterministe." />
  

<meta name="author" content="Serge-Étienne Parent">


<meta name="date" content="2018-11-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="entreposer-ses-donnees.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Préface</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="definitions.html"><a href="definitions.html"><i class="fa fa-check"></i><b>3</b> Définitions</a></li>
<li class="chapter" data-level="4" data-path="a-qui-sadresse-ce-manuel.html"><a href="a-qui-sadresse-ce-manuel.html"><i class="fa fa-check"></i><b>4</b> À qui s’adresse ce manuel?</a></li>
<li class="chapter" data-level="5" data-path="les-logiciels-libres.html"><a href="les-logiciels-libres.html"><i class="fa fa-check"></i><b>5</b> Les logiciels libres</a></li>
<li class="chapter" data-level="6" data-path="langage-de-programmation.html"><a href="langage-de-programmation.html"><i class="fa fa-check"></i><b>6</b> Langage de programmation</a><ul>
<li class="chapter" data-level="6.1" data-path="langage-de-programmation.html"><a href="langage-de-programmation.html#r"><i class="fa fa-check"></i><b>6.1</b> R</a></li>
<li class="chapter" data-level="6.2" data-path="langage-de-programmation.html"><a href="langage-de-programmation.html#pourquoi-pas-python"><i class="fa fa-check"></i><b>6.2</b> Pourquoi pas Python?</a></li>
<li class="chapter" data-level="6.3" data-path="langage-de-programmation.html"><a href="langage-de-programmation.html#pourquoi-pas-matlab"><i class="fa fa-check"></i><b>6.3</b> Pourquoi pas Matlab?</a></li>
<li class="chapter" data-level="6.4" data-path="langage-de-programmation.html"><a href="langage-de-programmation.html#pourquoi-pas-______"><i class="fa fa-check"></i><b>6.4</b> Pourquoi pas ______ ?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="comment-utiliser-ce-manuel.html"><a href="comment-utiliser-ce-manuel.html"><i class="fa fa-check"></i><b>7</b> Comment utiliser ce manuel?</a></li>
<li class="chapter" data-level="8" data-path="lectures-complementaires.html"><a href="lectures-complementaires.html"><i class="fa fa-check"></i><b>8</b> Lectures complémentaires</a><ul>
<li class="chapter" data-level="8.1" data-path="lectures-complementaires.html"><a href="lectures-complementaires.html#ecologie-mathematique"><i class="fa fa-check"></i><b>8.1</b> Écologie mathématique</a></li>
<li class="chapter" data-level="8.2" data-path="lectures-complementaires.html"><a href="lectures-complementaires.html#programmation"><i class="fa fa-check"></i><b>8.2</b> Programmation</a></li>
<li class="chapter" data-level="8.3" data-path="lectures-complementaires.html"><a href="lectures-complementaires.html#divers"><i class="fa fa-check"></i><b>8.3</b> Divers</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="besoin-daide.html"><a href="besoin-daide.html"><i class="fa fa-check"></i><b>9</b> Besoin d’aide?</a></li>
<li class="chapter" data-level="10" data-path="a-propos-de-lauteur.html"><a href="a-propos-de-lauteur.html"><i class="fa fa-check"></i><b>10</b> À propos de l’auteur</a></li>
<li class="chapter" data-level="11" data-path="un-cours-complementaire-a-dautres-cours.html"><a href="un-cours-complementaire-a-dautres-cours.html"><i class="fa fa-check"></i><b>11</b> Un cours complémentaire à d’autres cours</a></li>
<li class="chapter" data-level="12" data-path="contribuer-au-manuel.html"><a href="contribuer-au-manuel.html"><i class="fa fa-check"></i><b>12</b> Contribuer au manuel</a></li>
<li class="chapter" data-level="13" data-path="la-science-des-donnees-avec-r.html"><a href="la-science-des-donnees-avec-r.html"><i class="fa fa-check"></i><b>13</b> La science des données avec R</a></li>
<li class="chapter" data-level="14" data-path="statistiques-ou-science-des-donnees.html"><a href="statistiques-ou-science-des-donnees.html"><i class="fa fa-check"></i><b>14</b> Statistiques ou Science des données?</a></li>
<li class="chapter" data-level="15" data-path="organiser-son-environnement-de-travail-en-r.html"><a href="organiser-son-environnement-de-travail-en-r.html"><i class="fa fa-check"></i><b>15</b> Organiser son environnement de travail en R</a></li>
<li class="chapter" data-level="16" data-path="preparer-son-flux-de-travail.html"><a href="preparer-son-flux-de-travail.html"><i class="fa fa-check"></i><b>16</b> Préparer son flux de travail</a><ul>
<li class="chapter" data-level="16.1" data-path="preparer-son-flux-de-travail.html"><a href="preparer-son-flux-de-travail.html#installation-classique"><i class="fa fa-check"></i><b>16.1</b> Installation classique</a></li>
<li class="chapter" data-level="16.2" data-path="preparer-son-flux-de-travail.html"><a href="preparer-son-flux-de-travail.html#r-notebooks"><i class="fa fa-check"></i><b>16.2</b> R notebooks</a></li>
<li class="chapter" data-level="16.3" data-path="preparer-son-flux-de-travail.html"><a href="preparer-son-flux-de-travail.html#installation-avec-anaconda"><i class="fa fa-check"></i><b>16.3</b> Installation avec Anaconda</a></li>
<li class="chapter" data-level="16.4" data-path="preparer-son-flux-de-travail.html"><a href="preparer-son-flux-de-travail.html#utilisation-de-azure-notebooks"><i class="fa fa-check"></i><b>16.4</b> Utilisation de Azure notebooks</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html"><i class="fa fa-check"></i><b>17</b> Premiers pas avec R</a><ul>
<li class="chapter" data-level="17.1" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#types-de-donnees"><i class="fa fa-check"></i><b>17.1</b> Types de données</a></li>
<li class="chapter" data-level="17.2" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#les-collections-de-donnees"><i class="fa fa-check"></i><b>17.2</b> Les collections de données</a><ul>
<li class="chapter" data-level="17.2.1" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#vecteurs"><i class="fa fa-check"></i><b>17.2.1</b> Vecteurs</a></li>
<li class="chapter" data-level="17.2.2" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#matrices"><i class="fa fa-check"></i><b>17.2.2</b> Matrices</a></li>
<li class="chapter" data-level="17.2.3" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#listes"><i class="fa fa-check"></i><b>17.2.3</b> Listes</a></li>
<li class="chapter" data-level="17.2.4" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#tableaux"><i class="fa fa-check"></i><b>17.2.4</b> Tableaux</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#les-fonctions"><i class="fa fa-check"></i><b>17.3</b> Les fonctions</a></li>
<li class="chapter" data-level="17.4" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#les-boucles"><i class="fa fa-check"></i><b>17.4</b> Les boucles</a></li>
<li class="chapter" data-level="17.5" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#conditions-if-else-if-else"><i class="fa fa-check"></i><b>17.5</b> Conditions: if, else if, else</a></li>
<li class="chapter" data-level="17.6" data-path="premiers-pas-avec-r.html"><a href="premiers-pas-avec-r.html#installer-et-charger-un-module"><i class="fa fa-check"></i><b>17.6</b> Installer et charger un module</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="enfin.html"><a href="enfin.html"><i class="fa fa-check"></i><b>18</b> Enfin…</a></li>
<li class="chapter" data-level="19" data-path="visualisation.html"><a href="visualisation.html"><i class="fa fa-check"></i><b>19</b> Visualisation</a></li>
<li class="chapter" data-level="20" data-path="pourquoi-explorer-graphiquement.html"><a href="pourquoi-explorer-graphiquement.html"><i class="fa fa-check"></i><b>20</b> Pourquoi explorer graphiquement?</a></li>
<li class="chapter" data-level="21" data-path="publier-un-graphique.html"><a href="publier-un-graphique.html"><i class="fa fa-check"></i><b>21</b> Publier un graphique</a><ul>
<li class="chapter" data-level="21.1" data-path="publier-un-graphique.html"><a href="publier-un-graphique.html#cinq-qualites-dun-bon-graphique"><i class="fa fa-check"></i><b>21.1</b> Cinq qualités d’un bon graphique</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="choisir-le-type-de-graphique-le-plus-approprie.html"><a href="choisir-le-type-de-graphique-le-plus-approprie.html"><i class="fa fa-check"></i><b>22</b> Choisir le type de graphique le plus approprié</a></li>
<li class="chapter" data-level="23" data-path="choisir-son-outils-de-visualisation.html"><a href="choisir-son-outils-de-visualisation.html"><i class="fa fa-check"></i><b>23</b> Choisir son outils de visualisation</a><ul>
<li class="chapter" data-level="23.1" data-path="choisir-son-outils-de-visualisation.html"><a href="choisir-son-outils-de-visualisation.html#approche-imperative"><i class="fa fa-check"></i><b>23.1</b> Approche impérative</a></li>
<li class="chapter" data-level="23.2" data-path="choisir-son-outils-de-visualisation.html"><a href="choisir-son-outils-de-visualisation.html#approche-declarative"><i class="fa fa-check"></i><b>23.2</b> Approche déclarative</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="visualisation-en-r.html"><a href="visualisation-en-r.html"><i class="fa fa-check"></i><b>24</b> Visualisation en R</a></li>
<li class="chapter" data-level="25" data-path="module-de-base-pour-les-graphiques.html"><a href="module-de-base-pour-les-graphiques.html"><i class="fa fa-check"></i><b>25</b> Module de base pour les graphiques</a></li>
<li class="chapter" data-level="26" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html"><i class="fa fa-check"></i><b>26</b> La grammaire graphique ggplot2</a><ul>
<li class="chapter" data-level="26.1" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#mon-premier-ggplot"><i class="fa fa-check"></i><b>26.1</b> Mon premier ggplot</a><ul>
<li class="chapter" data-level="26.1.1" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#les-facettes"><i class="fa fa-check"></i><b>26.1.1</b> Les facettes</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#plusieurs-sources-de-donnees"><i class="fa fa-check"></i><b>26.2</b> Plusieurs sources de données</a></li>
<li class="chapter" data-level="26.3" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#exporter-avec-style"><i class="fa fa-check"></i><b>26.3</b> Exporter avec style</a></li>
<li class="chapter" data-level="26.4" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#nuages-de-points"><i class="fa fa-check"></i><b>26.4</b> Nuages de points</a></li>
<li class="chapter" data-level="26.5" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#diagrammes-en-lignes"><i class="fa fa-check"></i><b>26.5</b> Diagrammes en lignes</a></li>
<li class="chapter" data-level="26.6" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#les-histogrammes"><i class="fa fa-check"></i><b>26.6</b> Les histogrammes</a></li>
<li class="chapter" data-level="26.7" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#boxplots"><i class="fa fa-check"></i><b>26.7</b> Boxplots</a></li>
<li class="chapter" data-level="26.8" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#les-diagrammes-en-barre"><i class="fa fa-check"></i><b>26.8</b> Les diagrammes en barre</a></li>
<li class="chapter" data-level="26.9" data-path="la-grammaire-graphique-ggplot2.html"><a href="la-grammaire-graphique-ggplot2.html#exporter-un-graphique"><i class="fa fa-check"></i><b>26.9</b> Exporter un graphique</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="les-graphiques-comme-outil-dexploration-des-donnees.html"><a href="les-graphiques-comme-outil-dexploration-des-donnees.html"><i class="fa fa-check"></i><b>27</b> Les graphiques comme outil d’exploration des données</a><ul>
<li class="chapter" data-level="27.1" data-path="les-graphiques-comme-outil-dexploration-des-donnees.html"><a href="les-graphiques-comme-outil-dexploration-des-donnees.html#des-graphiques-interactifs"><i class="fa fa-check"></i><b>27.1</b> Des graphiques intéractifs!</a></li>
<li class="chapter" data-level="27.2" data-path="les-graphiques-comme-outil-dexploration-des-donnees.html"><a href="les-graphiques-comme-outil-dexploration-des-donnees.html#des-extensions-de-ggplot2"><i class="fa fa-check"></i><b>27.2</b> Des extensions de ggplot2</a></li>
<li class="chapter" data-level="27.3" data-path="les-graphiques-comme-outil-dexploration-des-donnees.html"><a href="les-graphiques-comme-outil-dexploration-des-donnees.html#aller-plus-loin-avec-ggplot2"><i class="fa fa-check"></i><b>27.3</b> Aller plus loin avec ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="choisir-les-bonnes-couleurs.html"><a href="choisir-les-bonnes-couleurs.html"><i class="fa fa-check"></i><b>28</b> Choisir les bonnes couleurs</a></li>
<li class="chapter" data-level="29" data-path="regles-particulieres.html"><a href="regles-particulieres.html"><i class="fa fa-check"></i><b>29</b> Règles particulières</a><ul>
<li class="chapter" data-level="29.1" data-path="regles-particulieres.html"><a href="regles-particulieres.html#ne-tronquez-pas-inutilement-laxe-des-y"><i class="fa fa-check"></i><b>29.1</b> Ne tronquez pas inutilement l’axe des <span class="math inline">\(y\)</span></a></li>
<li class="chapter" data-level="29.2" data-path="regles-particulieres.html"><a href="regles-particulieres.html#utilisez-un-encrage-proportionnel"><i class="fa fa-check"></i><b>29.2</b> Utilisez un encrage proportionnel</a></li>
<li class="chapter" data-level="29.3" data-path="regles-particulieres.html"><a href="regles-particulieres.html#publiez-vos-donnees"><i class="fa fa-check"></i><b>29.3</b> Publiez vos données</a></li>
<li class="chapter" data-level="29.4" data-path="regles-particulieres.html"><a href="regles-particulieres.html#evitez-de-distraire-avec-des-decorations-futiles"><i class="fa fa-check"></i><b>29.4</b> Évitez de distraire avec des décorations futiles</a></li>
<li class="chapter" data-level="29.5" data-path="regles-particulieres.html"><a href="regles-particulieres.html#visitez-www.junkcharts.typepad.com-de-temps-a-autre"><i class="fa fa-check"></i><b>29.5</b> Visitez www.junkcharts.typepad.com de temps à autre</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="organisation-des-donnees-et-operations-sur-des-tableaux.html"><a href="organisation-des-donnees-et-operations-sur-des-tableaux.html"><i class="fa fa-check"></i><b>30</b> Organisation des données et opérations sur des tableaux</a></li>
<li class="chapter" data-level="31" data-path="les-collections-de-donnees-1.html"><a href="les-collections-de-donnees-1.html"><i class="fa fa-check"></i><b>31</b> Les collections de données</a></li>
<li class="chapter" data-level="32" data-path="organiser-un-tableau-de-donnees.html"><a href="organiser-un-tableau-de-donnees.html"><i class="fa fa-check"></i><b>32</b> Organiser un tableau de données</a></li>
<li class="chapter" data-level="33" data-path="formats-de-tableau.html"><a href="formats-de-tableau.html"><i class="fa fa-check"></i><b>33</b> Formats de tableau</a><ul>
<li class="chapter" data-level="33.1" data-path="formats-de-tableau.html"><a href="formats-de-tableau.html#xls-ou-xlsx"><i class="fa fa-check"></i><b>33.1</b> <em>xls</em> ou <em>xlsx</em></a></li>
<li class="chapter" data-level="33.2" data-path="formats-de-tableau.html"><a href="formats-de-tableau.html#csv"><i class="fa fa-check"></i><b>33.2</b> <em>csv</em></a></li>
<li class="chapter" data-level="33.3" data-path="formats-de-tableau.html"><a href="formats-de-tableau.html#json"><i class="fa fa-check"></i><b>33.3</b> <em>json</em></a></li>
<li class="chapter" data-level="33.4" data-path="formats-de-tableau.html"><a href="formats-de-tableau.html#sqlite"><i class="fa fa-check"></i><b>33.4</b> SQLite</a></li>
<li class="chapter" data-level="33.5" data-path="formats-de-tableau.html"><a href="formats-de-tableau.html#suggestion"><i class="fa fa-check"></i><b>33.5</b> Suggestion</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="entreposer-ses-donnees.html"><a href="entreposer-ses-donnees.html"><i class="fa fa-check"></i><b>34</b> Entreposer ses données</a></li>
<li class="chapter" data-level="35" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html"><i class="fa fa-check"></i><b>35</b> Manipuler des données en mode tidyverse</a><ul>
<li class="chapter" data-level="35.1" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#importer-vos-donnees-dans-voter-session-de-travail"><i class="fa fa-check"></i><b>35.1</b> Importer vos données dans voter session de travail</a></li>
<li class="chapter" data-level="35.2" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#comment-selectionner-et-filtrer-des-donnees"><i class="fa fa-check"></i><b>35.2</b> Comment sélectionner et filtrer des données?</a><ul>
<li class="chapter" data-level="35.2.1" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#selectionner"><i class="fa fa-check"></i><b>35.2.1</b> Sélectionner</a></li>
<li class="chapter" data-level="35.2.2" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#filtrer"><i class="fa fa-check"></i><b>35.2.2</b> Filtrer</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#le-format-long-et-le-format-large"><i class="fa fa-check"></i><b>35.3</b> Le format long et le format large</a></li>
<li class="chapter" data-level="35.4" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#combiner-des-tableaux"><i class="fa fa-check"></i><b>35.4</b> Combiner des tableaux</a></li>
<li class="chapter" data-level="35.5" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#operations-sur-les-tableaux"><i class="fa fa-check"></i><b>35.5</b> Opérations sur les tableaux</a></li>
<li class="chapter" data-level="35.6" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#exemple-difficile"><i class="fa fa-check"></i><b>35.6</b> Exemple (difficile)</a></li>
<li class="chapter" data-level="35.7" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#exporter-un-tableau"><i class="fa fa-check"></i><b>35.7</b> Exporter un tableau</a></li>
<li class="chapter" data-level="35.8" data-path="manipuler-des-donnees-en-mode-tidyverse.html"><a href="manipuler-des-donnees-en-mode-tidyverse.html#aller-plus-loin-dans-le-tidyverse"><i class="fa fa-check"></i><b>35.8</b> Aller plus loin dans le tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>36</b> Références</a></li>
<li class="chapter" data-level="37" data-path="biostatistiques.html"><a href="biostatistiques.html"><i class="fa fa-check"></i><b>37</b> Biostatistiques</a></li>
<li class="chapter" data-level="38" data-path="populations-et-echantillons.html"><a href="populations-et-echantillons.html"><i class="fa fa-check"></i><b>38</b> Populations et échantillons</a></li>
<li class="chapter" data-level="39" data-path="les-variables.html"><a href="les-variables.html"><i class="fa fa-check"></i><b>39</b> Les variables</a><ul>
<li class="chapter" data-level="39.1" data-path="les-variables.html"><a href="les-variables.html#variables-quantitatives"><i class="fa fa-check"></i><b>39.1</b> Variables quantitatives</a></li>
<li class="chapter" data-level="39.2" data-path="les-variables.html"><a href="les-variables.html#variables-qualitatives"><i class="fa fa-check"></i><b>39.2</b> Variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="les-probabilites.html"><a href="les-probabilites.html"><i class="fa fa-check"></i><b>40</b> Les probabilités</a></li>
<li class="chapter" data-level="41" data-path="les-distributions.html"><a href="les-distributions.html"><i class="fa fa-check"></i><b>41</b> Les distributions</a><ul>
<li class="chapter" data-level="41.1" data-path="les-distributions.html"><a href="les-distributions.html#distribution-binomiale"><i class="fa fa-check"></i><b>41.1</b> Distribution binomiale</a></li>
<li class="chapter" data-level="41.2" data-path="les-distributions.html"><a href="les-distributions.html#distribution-de-poisson"><i class="fa fa-check"></i><b>41.2</b> Distribution de Poisson</a></li>
<li class="chapter" data-level="41.3" data-path="les-distributions.html"><a href="les-distributions.html#distribution-uniforme"><i class="fa fa-check"></i><b>41.3</b> Distribution uniforme</a></li>
<li class="chapter" data-level="41.4" data-path="les-distributions.html"><a href="les-distributions.html#distribution-normale"><i class="fa fa-check"></i><b>41.4</b> Distribution normale</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="statistiques-descriptives.html"><a href="statistiques-descriptives.html"><i class="fa fa-check"></i><b>42</b> Statistiques descriptives</a></li>
<li class="chapter" data-level="43" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html"><i class="fa fa-check"></i><b>43</b> Tests d’hypothèses à un et deux échantillons</a><ul>
<li class="chapter" data-level="43.0.1" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#information-lhypothese-nulle"><i class="fa fa-check"></i><b>43.0.1</b> Information: l’hypothèse nulle</a></li>
<li class="chapter" data-level="43.1" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#test-de-t-a-un-seul-echantillon"><i class="fa fa-check"></i><b>43.1</b> Test de t à un seul échantillon</a><ul>
<li class="chapter" data-level="43.1.1" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#information-la-p-value"><i class="fa fa-check"></i><b>43.1.1</b> Information: la <em>p-value</em></a></li>
</ul></li>
<li class="chapter" data-level="43.2" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#attention-mauvaises-interpretations-des-p-values"><i class="fa fa-check"></i><b>43.2</b> Attention: mauvaises interprétations des <em>p-values</em></a><ul>
<li class="chapter" data-level="43.2.1" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#attention-au-p-hacking"><i class="fa fa-check"></i><b>43.2.1</b> Attention au <em>p-hacking</em></a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#test-de-wilcoxon-a-un-seul-echantillon"><i class="fa fa-check"></i><b>43.3</b> Test de Wilcoxon à un seul échantillon</a></li>
<li class="chapter" data-level="43.4" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#tests-de-t-a-deux-echantillons"><i class="fa fa-check"></i><b>43.4</b> Tests de t à deux échantillons</a><ul>
<li class="chapter" data-level="43.4.1" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#enregistrer-les-resultats-dun-test"><i class="fa fa-check"></i><b>43.4.1</b> Enregistrer les résultats d’un test</a></li>
</ul></li>
<li class="chapter" data-level="43.5" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#comparaison-des-variances"><i class="fa fa-check"></i><b>43.5</b> Comparaison des variances</a></li>
<li class="chapter" data-level="43.6" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#tests-de-wilcoxon-a-deux-echantillons"><i class="fa fa-check"></i><b>43.6</b> Tests de Wilcoxon à deux échantillons</a></li>
<li class="chapter" data-level="43.7" data-path="tests-dhypotheses-a-un-et-deux-echantillons.html"><a href="tests-dhypotheses-a-un-et-deux-echantillons.html#les-tests-paires"><i class="fa fa-check"></i><b>43.7</b> Les tests pairés</a></li>
</ul></li>
<li class="chapter" data-level="44" data-path="lanalyse-de-variance.html"><a href="lanalyse-de-variance.html"><i class="fa fa-check"></i><b>44</b> L’analyse de variance</a></li>
<li class="chapter" data-level="45" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html"><i class="fa fa-check"></i><b>45</b> Les modèles statistiques</a><ul>
<li class="chapter" data-level="45.1" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#modeles-a-effets-fixes"><i class="fa fa-check"></i><b>45.1</b> Modèles à effets fixes</a><ul>
<li class="chapter" data-level="45.1.1" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#modele-lineaire-univarie-avec-variable-continue"><i class="fa fa-check"></i><b>45.1.1</b> Modèle linéaire univarié avec variable continue</a></li>
<li class="chapter" data-level="45.1.2" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#analyse-des-residus"><i class="fa fa-check"></i><b>45.1.2</b> Analyse des résidus</a></li>
<li class="chapter" data-level="45.1.3" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#regression-multiple"><i class="fa fa-check"></i><b>45.1.3</b> Régression multiple</a></li>
<li class="chapter" data-level="45.1.4" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#modeles-lineaires-univaries-avec-variable-categorielle-nominale"><i class="fa fa-check"></i><b>45.1.4</b> Modèles linéaires univariés avec variable catégorielle <strong>nominale</strong></a></li>
<li class="chapter" data-level="45.1.5" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#modeles-lineaires-univaries-avec-variable-categorielle-ordinale"><i class="fa fa-check"></i><b>45.1.5</b> Modèles linéaires univariés avec variable catégorielle <strong>ordinale</strong></a></li>
<li class="chapter" data-level="45.1.6" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#regression-multiple-a-plusieurs-variables"><i class="fa fa-check"></i><b>45.1.6</b> Régression multiple à plusieurs variables</a></li>
<li class="chapter" data-level="45.1.7" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#attention-a-ne-pas-surcharger-le-modele"><i class="fa fa-check"></i><b>45.1.7</b> Attention à ne pas surcharger le modèle</a></li>
<li class="chapter" data-level="45.1.8" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#les-modeles-lineaires-generalises"><i class="fa fa-check"></i><b>45.1.8</b> Les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="45.1.9" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#les-modeles-non-lineaires"><i class="fa fa-check"></i><b>45.1.9</b> Les modèles non-linéaires</a></li>
</ul></li>
<li class="chapter" data-level="45.2" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#modeles-a-effets-mixtes"><i class="fa fa-check"></i><b>45.2</b> Modèles à effets mixtes</a><ul>
<li class="chapter" data-level="45.2.1" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#modeles-mixtes-non-lineaires"><i class="fa fa-check"></i><b>45.2.1</b> Modèles mixtes non-linéaires</a></li>
</ul></li>
<li class="chapter" data-level="45.3" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#aller-plus-loin"><i class="fa fa-check"></i><b>45.3</b> Aller plus loin</a><ul>
<li class="chapter" data-level="45.3.1" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#statistiques-generales"><i class="fa fa-check"></i><b>45.3.1</b> Statistiques générales:</a></li>
<li class="chapter" data-level="45.3.2" data-path="les-modeles-statistiques.html"><a href="les-modeles-statistiques.html#statistiques-avec-r"><i class="fa fa-check"></i><b>45.3.2</b> Statistiques avec R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="46" data-path="autoapprentissage.html"><a href="autoapprentissage.html"><i class="fa fa-check"></i><b>46</b> Autoapprentissage</a><ul>
<li class="chapter" data-level="46.1" data-path="autoapprentissage.html"><a href="autoapprentissage.html#objectifs"><i class="fa fa-check"></i><b>46.1</b> Objectifs</a></li>
<li class="chapter" data-level="46.2" data-path="autoapprentissage.html"><a href="autoapprentissage.html#lexique"><i class="fa fa-check"></i><b>46.2</b> Lexique</a></li>
<li class="chapter" data-level="46.3" data-path="autoapprentissage.html"><a href="autoapprentissage.html#demarche"><i class="fa fa-check"></i><b>46.3</b> Démarche</a><ul>
<li class="chapter" data-level="46.3.1" data-path="autoapprentissage.html"><a href="autoapprentissage.html#pretraitement"><i class="fa fa-check"></i><b>46.3.1</b> Prétraitement</a></li>
<li class="chapter" data-level="46.3.2" data-path="autoapprentissage.html"><a href="autoapprentissage.html#entrainement-et-test"><i class="fa fa-check"></i><b>46.3.2</b> Entraînement et test</a></li>
<li class="chapter" data-level="46.3.3" data-path="autoapprentissage.html"><a href="autoapprentissage.html#sousapprentissage-et-surapprentissage"><i class="fa fa-check"></i><b>46.3.3</b> Sousapprentissage et surapprentissage</a></li>
<li class="chapter" data-level="46.3.4" data-path="autoapprentissage.html"><a href="autoapprentissage.html#validation-croisee"><i class="fa fa-check"></i><b>46.3.4</b> Validation croisée</a></li>
<li class="chapter" data-level="46.3.5" data-path="autoapprentissage.html"><a href="autoapprentissage.html#choix-de-lalgorithme-dapprentissage"><i class="fa fa-check"></i><b>46.3.5</b> Choix de l’algorithme d’apprentissage</a></li>
<li class="chapter" data-level="46.3.6" data-path="autoapprentissage.html"><a href="autoapprentissage.html#deploiement"><i class="fa fa-check"></i><b>46.3.6</b> Déploiement</a></li>
</ul></li>
<li class="chapter" data-level="46.4" data-path="autoapprentissage.html"><a href="autoapprentissage.html#algorithmes"><i class="fa fa-check"></i><b>46.4</b> Algorithmes</a></li>
<li class="chapter" data-level="46.5" data-path="autoapprentissage.html"><a href="autoapprentissage.html#lautoapprentissage-en-r"><i class="fa fa-check"></i><b>46.5</b> L’autoapprentissage en R</a></li>
<li class="chapter" data-level="46.6" data-path="autoapprentissage.html"><a href="autoapprentissage.html#les-k-plus-proches-voisins"><i class="fa fa-check"></i><b>46.6</b> Les <em>k</em> plus proches voisins</a><ul>
<li class="chapter" data-level="46.6.1" data-path="autoapprentissage.html"><a href="autoapprentissage.html#exemple-dapplication-1"><i class="fa fa-check"></i><b>46.6.1</b> Exemple d’application</a></li>
</ul></li>
<li class="chapter" data-level="46.7" data-path="autoapprentissage.html"><a href="autoapprentissage.html#les-arbres-decisionnels"><i class="fa fa-check"></i><b>46.7</b> Les arbres décisionnels</a></li>
</ul></li>
<li class="chapter" data-level="47" data-path="les-reseaux-neuronaux.html"><a href="les-reseaux-neuronaux.html"><i class="fa fa-check"></i><b>47</b> Les réseaux neuronaux</a><ul>
<li class="chapter" data-level="47.0.1" data-path="les-reseaux-neuronaux.html"><a href="les-reseaux-neuronaux.html#les-reseaux-neuronnaux-sur-r-avec-keras"><i class="fa fa-check"></i><b>47.0.1</b> Les réseaux neuronnaux sur R avec Keras</a></li>
<li class="chapter" data-level="47.0.2" data-path="les-reseaux-neuronaux.html"><a href="les-reseaux-neuronaux.html#pour-aller-plus-loin"><i class="fa fa-check"></i><b>47.0.2</b> Pour aller plus loin</a></li>
</ul></li>
<li class="chapter" data-level="48" data-path="les-processus-gaussiens.html"><a href="les-processus-gaussiens.html"><i class="fa fa-check"></i><b>48</b> Les processus gaussiens</a><ul>
<li class="chapter" data-level="48.1" data-path="les-processus-gaussiens.html"><a href="les-processus-gaussiens.html#un-approche-intuitive"><i class="fa fa-check"></i><b>48.1</b> Un approche intuitive</a><ul>
<li class="chapter" data-level="48.1.1" data-path="les-processus-gaussiens.html"><a href="les-processus-gaussiens.html#les-processus-gaussiens-en-r"><i class="fa fa-check"></i><b>48.1.1</b> Les processus gaussiens en <code>R</code></a></li>
<li class="chapter" data-level="48.1.2" data-path="les-processus-gaussiens.html"><a href="les-processus-gaussiens.html#application-pratique"><i class="fa fa-check"></i><b>48.1.2</b> Application pratique</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="49" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html"><i class="fa fa-check"></i><b>49</b> Modélisation déterministe</a><ul>
<li class="chapter" data-level="49.1" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html#equations-differentielles"><i class="fa fa-check"></i><b>49.1</b> Équations différentielles</a></li>
<li class="chapter" data-level="49.2" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html#objectifs-1"><i class="fa fa-check"></i><b>49.2</b> Objectifs</a></li>
<li class="chapter" data-level="49.3" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html#les-equations-differentielles-ordinaires-en-modelisation-ecologique"><i class="fa fa-check"></i><b>49.3</b> Les équations différentielles ordinaires en modélisation écologique</a><ul>
<li class="chapter" data-level="49.3.1" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html#evolution-dune-seule-population-en-fonction-du-temps"><i class="fa fa-check"></i><b>49.3.1</b> Évolution d’une seule population en fonction du temps</a></li>
<li class="chapter" data-level="49.3.2" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html#population-exploitee"><i class="fa fa-check"></i><b>49.3.2</b> Population exploitée</a></li>
<li class="chapter" data-level="49.3.3" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html#interactions-biologiques"><i class="fa fa-check"></i><b>49.3.3</b> Intéractions biologiques</a></li>
</ul></li>
<li class="chapter" data-level="49.4" data-path="modelisation-deterministe.html"><a href="modelisation-deterministe.html#les-equations-differentielles-partielles-en-modelisation-ecologique"><i class="fa fa-check"></i><b>49.4</b> Les équations différentielles partielles en modélisation écologique</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse et modélisation d’agroécosystèmes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manipuler-des-donnees-en-mode-tidyverse" class="section level1">
<h1><span class="header-section-number">35</span> Manipuler des données en mode tidyverse</h1>
<p>Le méta-module tidyverse regroupe une collection de précieux modules pour l’analyse de données en R. Il permet d’importer des données dans votre session de travail avec readr, de les explorer avec ggplot2, de les transformer avec tidyr et dplyr et de les exporter aevc readr. Les tableaux de classe <em>data.frame</em>, comme ceux de la plus moderne classe <em>tibble</em>, peuvent être manipulés à travers le flux de travail pour l’analyse et la modélisation (chapitres suivants). Comme c’était le cas pour le chapitre sur la visualisation, ce chapitre est loin de couvrir les nombreuses fonctionnalités qui sont offertes dans le tidyverse.</p>
<div id="importer-vos-donnees-dans-voter-session-de-travail" class="section level2">
<h2><span class="header-section-number">35.1</span> Importer vos données dans voter session de travail</h2>
<p>Supposons que vous avec bien organisé vos données en mode <em>tidy</em>. Pour les importer dans votre session et commencer à les inspecter, vous lancerez une des commandes du module readr, décrites dans la documentation dédiée.</p>
<ul>
<li><code>read_csv()</code> si le séparateur de colonne est une virgule</li>
<li><code>read_csv2()</code> si le séparateur de colonne est un point-virgule et que le séparateur décimal est une virgule</li>
<li><code>read_tsv()</code> si le séparateur de colonne est une tabulation</li>
<li><code>read_table()</code> si le séparateur de colonne est un espace blanc</li>
<li><code>read_delim()</code> si le séparateur de colonne est un autre caractère (comme le point-virgule) que vous spécifierez dans l’argument <code>delim = &quot;;&quot;</code></li>
</ul>
<p>Les principaux arguments sont les suivants.</p>
<ul>
<li><code>file</code>: le chemin vers le fichier. Ce chemin peut aussi bien être une adresse locale (data/…) qu’une adresse internet (<a href="https://" class="uri">https://</a>…).</li>
<li><code>delim</code>: le symbole délimitant les colonnes dans le cas de <code>read_delim</code>.</li>
<li><code>col_names</code>: si TRUE, la première ligne est l’entête du tableau, sinon FALSE. Si vous spécifiez un vecteur numérique, ce sont les numéros des lignes utilisées pour le nom de l’entête. Si vous utilisez un vecteur de charactères, ce sont les noms des colonnes que vous désirez donner à votre tableau.</li>
<li><code>na</code>: le symbole spécifiant une valeur manquante. L’argument <code>na=''</code> signifie que les cellules vides sont des données manquantes. Si les valeurs manquantes ne sont pas uniformes, vous pouvez les indiquer dans un vecteur, par exemple <code>na = c(&quot;&quot;, &quot;NA&quot;, &quot;NaN&quot;, &quot;.&quot;, &quot;-&quot;)</code>.</li>
<li><code>local</code>: cet argument prend une fonction <code>local()</code> qui peut inclure des arguments de format de temps, mais aussi d’encodage (<a href="https://readr.tidyverse.org/reference/locale.html">voir documentation</a>)</li>
</ul>
<p>D’autres arguments peuvent être spécifiés au besoin, et les répéter ici dupliquerait l’information de la documentation de <a href="https://readr.tidyverse.org/reference/read_delim.html">la fonction <code>read_csv</code> de readr</a>.</p>
<p>Je déconseille d’importer des données en format xls ou xlsx. Si toutefois cela vous convient, je vous réfère au module <a href="https://readxl.tidyverse.org/">readxl</a>.</p>
<p>L’<a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">aide-mémoire de readr</a> est à afficher près de soi.</p>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf"><img src="https://www.rstudio.com/wp-content/uploads/2015/01/data-import-cheatsheet-1-600x464.png" /></a>
Aide-mémoire de readr, source: <a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a></p>
<p>Nous allons charger des données de culture de la chicouté (<em>Rubus chamaemorus</em>), un petit fruit nordique, tiré de Parent et al. (2013). Ouvrons d’abord le fichier pour vérifier les séparateurs de colonne et de décimale.</p>
<p><img src="images/04_chicoute-csv-atom.png" /></p>
<p>Le séparateur de colonne est un point-virgule et le décimal est une virgule.</p>
<p>Avec <a href="https://atom.io/">Atom</a>, mon éditeur texte préféré, je vais dans Edit &gt; Select Encoding et j’obtiens bien le UTF-8.</p>
<p><img src="images/04_chicoute-csv-encoding.png" /></p>
<p>Nous allons donc utiliser <code>read_csv2()</code> avec ses arguments par défaut.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a>
<a class="sourceLine" id="cb179-2" data-line-number="2">chicoute &lt;-<span class="st"> </span><span class="kw">read_csv2</span>(<span class="st">&#39;data/chicoute.csv&#39;</span>)</a></code></pre></div>
<pre><code>## Using &#39;,&#39; as decimal and &#39;.&#39; as grouping mark. Use read_delim() for more control.</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_double(),
##   CodeTourbiere = col_character(),
##   Ordre = col_character(),
##   Traitement = col_character(),
##   DemiParcelle = col_character(),
##   SousTraitement = col_character()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<p>Quelques commandes utiles inspecter le tableau:</p>
<ul>
<li><code>head()</code> présente l’entête du tableau, soit ses 6 premières lignes</li>
<li><code>str()</code> et <code>glimpse()</code> présentent les variables du tableau et leur type - <code>glimpse()</code>est la fonction tidyverse et <code>str()</code> est la fonction classique (je préfère <code>str()</code>)</li>
<li><code>summary()</code> présente des statistiques de base du tableau</li>
<li><code>names()</code> ou <code>colnames()</code> sort les noms des colonnes sous forme d’un vecteur</li>
<li><code>dim()</code> donne les dimensions du tableau, <code>ncol()</code> son nombre de colonnes et <code>nrow()</code> son nombre de lignes</li>
<li><code>skim</code> est une fonction du module skimr montrant un portrait graphique et numérique du tableau</li>
</ul>
<p><strong>Extra 1</strong>. Plusieurs modules ne se trouvent pas dans les dépôt CRAN, mais sont disponibles sur GitHub. Pour les installer, installez d’abord le module devtools disponible sur CRAN. Vous pourrez alors installer les packages de GitHub comme on le fait avec le package skimr.</p>
<p><strong>Extra 2</strong>. Lorsque je désire utiliser une fonction, mais sans charger le module dans la session, j’utilise la notation <code>module::fonction</code>. Comme dans ce cas, pour skimr.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="co"># devtools::install_github(&quot;ropenscilabs/skimr&quot;)</span></a>
<a class="sourceLine" id="cb183-2" data-line-number="2">skimr<span class="op">::</span><span class="kw">skim</span>(chicoute)</a></code></pre></div>
<pre><code>## Skim summary statistics
##  n obs: 90 
##  n variables: 31 
## 
## -- Variable type:character ---------------------------------------------------------
##        variable missing complete  n min max empty n_unique
##   CodeTourbiere       0       90 90   1   4     0       12
##    DemiParcelle      50       40 90   4   5     0        2
##           Ordre       0       90 90   1   2     0       20
##  SousTraitement      50       40 90   1   7     0        3
##      Traitement      50       40 90   6  11     0        2
## 
## -- Variable type:numeric -----------------------------------------------------------
##                  variable missing complete  n          mean         sd
##                  Al_pourc       0       90 90       0.0027     0.0013 
##                   B_pourc       0       90 90       0.0031     0.00067
##                   C_pourc       0       90 90      50.28       1.61   
##                  Ca_pourc       0       90 90       0.39       0.1    
##                  Cu_pourc       0       90 90       0.00041    0.00064
##                  Fe_pourc       0       90 90       0.015      0.0059 
##   FemelleAvorte_nombre_m2       4       86 90       8.49      14.52   
##    FemelleFruit_nombre_m2      18       72 90      19.97      23.79   
##                        ID       0       90 90      45.5       26.12   
##                   K_pourc       0       90 90       0.89       0.27   
##                Latitude_m       0       90 90 5701839.86    1915.5    
##               Longitude_m       0       90 90  485295.54    6452.33   
##                  Mg_pourc       0       90 90       0.5        0.085  
##                  Mn_pourc       0       90 90       0.033      0.025  
##                   N_pourc       0       90 90       2.2        0.4    
##                   P_pourc       0       90 90       0.14       0.037  
##           Rendement_g_5m2      50       40 90      13.33      21.56   
##                   S_pourc       0       90 90       0.13       0.039  
##                      Site       0       90 90       6.33       5.49   
##    SterileFleur_nombre_m2       4       86 90       0.26       0.71   
##    TotalFemelle_nombre_m2       4       86 90      27.53      29.83   
##     TotalFloral_nombre_m2       4       86 90      52.08      40.41   
##       TotalMale_nombre_m2       4       86 90      24.4       26.87   
##      TotalRamet_nombre_m2       0       90 90     251.26     156.06   
##  TotalVegetatif_nombre_m2       4       86 90     199.02     139.13   
##                  Zn_pourc       0       90 90       0.0067     0.0021 
##             p0           p25           p50           p75         p100
##    9e-04             0.0019        0.0024        0.0033        0.0093
##        0.0018        0.0026        0.0032        0.0035        0.0042
##       46.72         49.14         50.45         51.58         53.83  
##        0.19          0.32          0.37          0.44          0.88  
##        3.7e-05       3.7e-05       0.00021       0.00046       0.0042
##        0.0091        0.011         0.014         0.017         0.052 
##        0             1.27          3.07         10.14         76.8   
##        0.4           7.64         11.46         22.83        157.88  
##        1            23.25         45.5          67.75         90     
##        0.35          0.69          0.86          1.13          1.54  
##  5695688       5701868.5     5702129       5702537       5706394     
##   459873        485927        486500        486544.75     491955     
##        0.36          0.45          0.48          0.52          0.86  
##        0.0023        0.012         0.028         0.05          0.1   
##        1.53          1.89          2.12          2.58          3.1   
##        0.071         0.12          0.14          0.16          0.23  
##        0             0             0.95         15.63         72.44  
##        0.07          0.11          0.13          0.14          0.28  
##        1             2             4             9            20     
##        0             0             0             0             3.82  
##        2.55         10.34         17.19         31.96        187.17  
##        4.8          22.92         43            69.52        198.62  
##        0             3.3          15.28         36.51        104.41  
##       40.74        122.7         212.92        347.8         651.9   
##       22.92         86.26        161.25        263.78        580.6   
##        0.0033        0.0055        0.0063        0.0072        0.016 
##      hist
##  &lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2585&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2585&gt;&lt;U+2583&gt;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2585&gt;
##  &lt;U+2582&gt;&lt;U+2583&gt;&lt;U+2586&gt;&lt;U+2583&gt;&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;
##  &lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2585&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;
##  &lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2583&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;
##  &lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2587&gt;&lt;U+2581&gt;
##  &lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2583&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2583&gt;&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2585&gt;&lt;U+2583&gt;&lt;U+2582&gt;
##  &lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2582&gt;&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2585&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2581&gt;
##  &lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2581&gt;
##  &lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2585&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;</code></pre>
<p><strong>Exercice</strong>. Inspectez le tableau.</p>
</div>
<div id="comment-selectionner-et-filtrer-des-donnees" class="section level2">
<h2><span class="header-section-number">35.2</span> Comment sélectionner et filtrer des données?</h2>
<p>On utiliser le terme <em>sélectionner</em> lorsque l’on désire choisir une ou plusieurs lignes et colonnes d’un tableau (la plupart du temps des colonnes). L’action de <em>filtrer</em> signifie de sélectionner des lignes selon certains critères.</p>
<div id="selectionner" class="section level3">
<h3><span class="header-section-number">35.2.1</span> Sélectionner</h3>
<p>Voici trois manières de sélectionner une colonne en R.</p>
<ul>
<li>Une méthode rapide mais peu expressive consiste à indiquer les valeurs numériques de l’indice de la colonne entre des crochets. Il s’agit d’appeler le tableau suivit de crochets. L’intérieur des crochets comprend deux éléments séparés par une virgule. Le premier élément sert à filter selon l’indice, le deuxième sert à sélectionner selon l’indice. Ainsi:</li>
<li><code>chicoute[, 1]</code>: sélectionner la première colonne</li>
<li><code>chicoute[, 1:10]</code>: sélectionner les 10 premières colonnes</li>
<li><code>chicoute[, c(2, 4, 5)]</code>: sélectionner les colonnes 2, 4 et 5</li>
<li><p><code>chicoute[c(10, 13, 20), c(2, 4, 5)]</code>: sélectionner les colonnes 2, 4 et 5 et les lignes 10, 13 et 20.</p></li>
<li><p>Une autre méthode rapide, mais plus expressive, consiste à appeler le tableau, suivi du symbole <code>$</code>, puis le nom de la colonne.</p></li>
</ul>
<blockquote>
<p><strong>Truc</strong>. La plupart des IDE, comme RStudio, peuvent vous proposer des colonnes dans une liste. Après avoir entrer le <code>$</code>, taper sur la touche de tabulation: vous pourrez sélectionner la colonne dans une liste défilante.</p>
</blockquote>
<p><img src="images/04_auto-complete-cols.png" /></p>
<ul>
<li><p>Une autre option est d’inscrire le nom de la colonne, ou du vecteur des colonnes, entre des crochets suivant le nom du tableau, c’est-à-dire <code>chicoute[c(&quot;Site&quot;, &quot;Latitude_m&quot;, &quot;Longitude_m&quot;)]</code>.</p></li>
<li><p>Enfin, dans une séquence d’opérations en mode pipeline (chaque opération est mise à la suite de la précédente en plaçant le <em>pipe</em> <code>%&gt;%</code> entre chacune), il peut être préférable de sélectionner des colonnes avec la fonction <code>select()</code>, i.e.</p></li>
</ul>
<pre><code>chicoute %&gt;%
select(Site, Latitude_m, Longitude_m)</code></pre>
<p>La fonction <code>select()</code> permet aussi de travailler en exclusion. Ainsi pour enlever des colonnes, on placera un <code>-</code> (signe de soustraction) devant le nom de la colonne.</p>
<p>D’autre arguments de <code>select()</code> permettent une sélection rapide. Par exemple, pour obtenir les colonnes contenant des pourcentages:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb186-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;pourc&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb186-3" data-line-number="3"><span class="st">  </span><span class="kw">head</span>(<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 13
##   C_pourc N_pourc P_pourc K_pourc Ca_pourc Mg_pourc S_pourc B_pourc
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1    51.5    1.72  0.108     1.21    0.435    0.470  0.0976 0.00258
## 2    51.3    2.18  0.0985    1.22    0.337    0.439  0.0996 0.00258
## 3    50.6    2.12  0.0708    1.05    0.373    0.420  0.104  0.00258
## # ... with 5 more variables: Cu_pourc &lt;dbl&gt;, Zn_pourc &lt;dbl&gt;,
## #   Mn_pourc &lt;dbl&gt;, Fe_pourc &lt;dbl&gt;, Al_pourc &lt;dbl&gt;</code></pre>
</div>
<div id="filtrer" class="section level3">
<h3><span class="header-section-number">35.2.2</span> Filtrer</h3>
<p>Comme c’est le cas de la sélection, on pourra filtrer un tableau de plusieurs manières. J’ai déjà présenté comment filtrer selon les indices des lignes. Les autres manières reposent néanmoins sur une opération logique <code>==</code>, <code>&lt;</code>, <code>&gt;</code> ou <code>%in%</code> (le %in% signifie <em>se trouve parmi</em> et peut être suivi d’un vecteur de valeur que l’on désire accepter).</p>
<p>Les conditions booléennes peuvent être combinées avec les opérateurs <em>et</em>, <code>&amp;</code>, et <em>ou</em>, <code>|</code>. Pour rappel,</p>
<table>
<thead>
<tr class="header">
<th>Opération</th>
<th>Résultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Vrai <strong>et</strong> Vrai</td>
<td>Vrai</td>
</tr>
<tr class="even">
<td>Vrai <strong>et</strong> Faux</td>
<td>Faux</td>
</tr>
<tr class="odd">
<td>Faux <strong>et</strong> Faux</td>
<td>Faux</td>
</tr>
<tr class="even">
<td>Vrai <strong>ou</strong> Vrai</td>
<td>Vrai</td>
</tr>
<tr class="odd">
<td>Vrai <strong>ou</strong> Faux</td>
<td>Vrai</td>
</tr>
<tr class="even">
<td>Faux <strong>ou</strong> Faux</td>
<td>Faux</td>
</tr>
</tbody>
</table>
<ul>
<li>La méthode classique consiste à appliquer une opération logique entre les crochets, par exemple <code>chicoute[chicoute$CodeTourbiere == &quot;BEAU&quot;, ]</code></li>
<li>La méthode tidyverse, plus pratique en mode pipeline, passe par la fonction <code>filter()</code>, i.e.</li>
</ul>
<pre><code>chicoute %&gt;%
filter(CodeTourbiere == &quot;BEAU&quot;)</code></pre>
<p>Combiner le tout.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb189-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(Ca_pourc <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.4</span> <span class="op">&amp;</span><span class="st"> </span>CodeTourbiere <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BEAU&quot;</span>, <span class="st">&quot;MB&quot;</span>, <span class="st">&quot;WTP&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb189-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;pourc&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 13
##   C_pourc N_pourc P_pourc K_pourc Ca_pourc Mg_pourc S_pourc B_pourc
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1    51.3    2.18  0.0985   1.22     0.337    0.439  0.0996 0.00258
## 2    50.6    2.12  0.0708   1.05     0.373    0.420  0.104  0.00258
## 3    53.8    2.04  0.115    0.947    0.333    0.472  0.106  0.00258
## 4    52.6    2.11  0.0847   0.913    0.328    0.376  0.111  0.00296
## # ... with 5 more variables: Cu_pourc &lt;dbl&gt;, Zn_pourc &lt;dbl&gt;,
## #   Mn_pourc &lt;dbl&gt;, Fe_pourc &lt;dbl&gt;, Al_pourc &lt;dbl&gt;</code></pre>
</div>
</div>
<div id="le-format-long-et-le-format-large" class="section level2">
<h2><span class="header-section-number">35.3</span> Le format long et le format large</h2>
<p>Dans le tableau <code>chicoute</code>, chaque élément possède sa propre colonne. Si l’on voulait mettre en graphique les boxplot des facettes de concentrations d’azote, de phosphore et de potassium dans les différentes tourbières, il faudrait obtenir une seule colonne de concentrations.</p>
<p>Pour ce faire, nous utiliserons la fonction <code>gather()</code>. Le premier argument est le nom de la colonne des variables, le deuxième est le nom de la nouvelle colonne des valeurs. La suite consiste à décrire les colonnes à inclure ou à exclulre. Dans le cas qui suit, j’exclue CodeTourbiere de la refonte j’utilise <code>sample_n()</code> pour présenter un échantillon du résultat.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1">chicoute_long &lt;-<span class="st"> </span>chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(CodeTourbiere, N_pourc, P_pourc, K_pourc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb191-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> element, <span class="dt">value =</span> concentration, <span class="op">-</span>CodeTourbiere)</a>
<a class="sourceLine" id="cb191-4" data-line-number="4">chicoute_long <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    CodeTourbiere element concentration
##    &lt;chr&gt;         &lt;chr&gt;           &lt;dbl&gt;
##  1 2             K_pourc         1.34 
##  2 2             K_pourc         0.831
##  3 2             K_pourc         1.06 
##  4 2             P_pourc         0.166
##  5 NTP           K_pourc         0.398
##  6 2             N_pourc         2.70 
##  7 BEAU          N_pourc         1.72 
##  8 WTP           K_pourc         0.557
##  9 BS2           N_pourc         2.44 
## 10 BS2           P_pourc         0.118</code></pre>
<p>L’opération inverse est <code>spread()</code>. Pour que cette opération fonctionne, <code>spread()</code> a besoin d’une colonne ayant un identifiant unique.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1">chicoute_long<span class="op">$</span>ID &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(chicoute_long)</a></code></pre></div>
<p>Nous pouvons enlever cet identifiant une fois l’opération effectuée.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">chicoute_large &lt;-<span class="st"> </span>chicoute_long <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb194-2" data-line-number="2"><span class="st">  </span><span class="kw">spread</span>(<span class="dt">key=</span>element, <span class="dt">value=</span>concentration, <span class="dt">fill=</span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb194-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ID)</a>
<a class="sourceLine" id="cb194-4" data-line-number="4">chicoute_large <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 4
##    CodeTourbiere K_pourc N_pourc P_pourc
##    &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 1               0        2.12       0
##  2 1               0        1.82       0
##  3 BEAU            0.947    0          0
##  4 1               0        2.22       0
##  5 MR              0.934    0          0
##  6 MR              0        2.06       0
##  7 MR              0        2.09       0
##  8 2               0        2.78       0
##  9 BS2             0        2.44       0
## 10 1               0.752    0          0</code></pre>
<p>Sans créer de nouveau tableau, il est possible de créer le graphique dans un seu pipeline.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb196-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(CodeTourbiere, N_pourc, P_pourc, K_pourc) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb196-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> element, <span class="dt">value =</span> concentration, <span class="op">-</span>CodeTourbiere) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb196-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> CodeTourbiere, <span class="dt">y =</span> concentration)) <span class="op">+</span></a>
<a class="sourceLine" id="cb196-5" data-line-number="5"><span class="st">  </span><span class="kw">facet_grid</span>(element <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb196-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
<div id="combiner-des-tableaux" class="section level2">
<h2><span class="header-section-number">35.4</span> Combiner des tableaux</h2>
<p>Nous avons introduit plus haut la notion de base de données. Nous voudrions peut-être utiliser le code des tourbières pour inclure leur nom, le type d’essai mené à ces tourbières, etc. Importons d’abord le tableau des noms liés aux codes.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1">tourbieres &lt;-<span class="st"> </span><span class="kw">read_csv2</span>(<span class="st">&quot;data/chicoute_tourbieres.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Using &#39;,&#39; as decimal and &#39;.&#39; as grouping mark. Use read_delim() for more control.</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Tourbiere = col_character(),
##   CodeTourbiere = col_character(),
##   Type = col_character(),
##   TypeCulture = col_character()
## )</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1">tourbieres</a></code></pre></div>
<pre><code>## # A tibble: 11 x 4
##    Tourbiere               CodeTourbiere Type        TypeCulture
##    &lt;chr&gt;                   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;      
##  1 Beaulieu                BEAU          calibration naturel    
##  2 Brador Path             BP            calibration naturel    
##  3 Lichen (BS2E)           2             validation  cultive sec
##  4 Mannys Brook            MB            calibration naturel    
##  5 Middle Bay Road         MR            calibration naturel    
##  6 North Est of Smelt Pond NESP          calibration naturel    
##  7 North of Blue Moon      NBM           calibration naturel    
##  8 South of Smelt Pond     SSP           calibration naturel    
##  9 Sphaigne (BS2F)         BS2           validation  cultive sec
## 10 Sphaigne (BS2F)         1             calibration naturel    
## 11 West of Trout Pond      WTP           calibration naturel</code></pre>
<p>Notre information est organisée en deux tableaux, liés par la colonne <code>CodeTourbiere</code>. Comment fusionner l’information pour qu’elle puisse être utilisée dans son ensemble? La fonction <code>left_join</code> effectue cette opération typique avec les bases de données.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1">chicoute_merge &lt;-<span class="st"> </span><span class="kw">left_join</span>(<span class="dt">x =</span> chicoute, <span class="dt">y =</span> tourbieres, <span class="dt">by =</span> <span class="st">&quot;CodeTourbiere&quot;</span>)</a>
<a class="sourceLine" id="cb202-2" data-line-number="2"><span class="co"># ou bien chicoute %&gt;% left_join(y = tourbieres, by = &quot;CodeTourbiere&quot;)</span></a>
<a class="sourceLine" id="cb202-3" data-line-number="3">chicoute_merge <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 34
##      ID CodeTourbiere Ordre  Site Traitement DemiParcelle SousTraitement
##   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;         
## 1    81 1             4         8 temoin     right        Cu            
## 2    83 1             5         9 fertilisa~ right        Control       
## 3     2 BEAU          A         2 &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;          
## 4    66 1             1         1 fertilisa~ left         B             
## # ... with 27 more variables: Latitude_m &lt;dbl&gt;, Longitude_m &lt;dbl&gt;,
## #   Rendement_g_5m2 &lt;dbl&gt;, TotalRamet_nombre_m2 &lt;dbl&gt;,
## #   TotalVegetatif_nombre_m2 &lt;dbl&gt;, TotalFloral_nombre_m2 &lt;dbl&gt;,
## #   TotalMale_nombre_m2 &lt;dbl&gt;, TotalFemelle_nombre_m2 &lt;dbl&gt;,
## #   FemelleFruit_nombre_m2 &lt;dbl&gt;, FemelleAvorte_nombre_m2 &lt;dbl&gt;,
## #   SterileFleur_nombre_m2 &lt;dbl&gt;, C_pourc &lt;dbl&gt;, N_pourc &lt;dbl&gt;,
## #   P_pourc &lt;dbl&gt;, K_pourc &lt;dbl&gt;, Ca_pourc &lt;dbl&gt;, Mg_pourc &lt;dbl&gt;,
## #   S_pourc &lt;dbl&gt;, B_pourc &lt;dbl&gt;, Cu_pourc &lt;dbl&gt;, Zn_pourc &lt;dbl&gt;,
## #   Mn_pourc &lt;dbl&gt;, Fe_pourc &lt;dbl&gt;, Al_pourc &lt;dbl&gt;, Tourbiere &lt;chr&gt;,
## #   Type &lt;chr&gt;, TypeCulture &lt;chr&gt;</code></pre>
<p>D’autres types de jointures sont possibles, et décrites en détails dans la <a href="https://dplyr.tidyverse.org/reference/join.html">documentation</a>.</p>
<p><a href="https://www.garrickadenbuie.com/">Garrick Aden-Buie</a> a préparé de <a href="https://gist.github.com/gadenbuie/077bcd2700ac1241c65c324581a9f619">jolies animations</a> pour décrire les différents types de jointures.</p>
<p><code>left_join(x, y)</code> colle y à x seulement ce qui dans y correspond à ce que l’on trouve dans x.</p>
<p><img src="images/04_animated-left-join.gif" /></p>
<p><code>right_join(x, y)</code> colle y à x seulement ce qui dans x correspond à ce que l’on trouve dans y.</p>
<p><img src="images/04_animated-right-join.gif" /></p>
<p><code>inner_join(x, y)</code> colle x et y en excluant les lignes où au moins une variable de joint est absente dans x et y.</p>
<p><img src="images/04_animated-inner-join.gif" /></p>
<p><code>full_join(x, y)</code>garde toutes les lignes et les colonnes de x et y.</p>
<p><img src="images/04_animated-full-join.gif" /></p>
</div>
<div id="operations-sur-les-tableaux" class="section level2">
<h2><span class="header-section-number">35.5</span> Opérations sur les tableaux</h2>
<p>Les tableaux peuvent être segmentés en éléments sur lesquels on calculera ce qui nous chante.</p>
<p>On pourrait vouloir obtenir:</p>
<ul>
<li>la somme avec la function <code>sum()</code></li>
<li>la moyenne avec la function <code>mean()</code> ou la médiane avec la fonction <code>median()</code></li>
<li>l’écart-type avec la function <code>sd()</code></li>
<li>les maximum et minimum avec les fonctions <code>min()</code> et <code>max()</code></li>
<li>un décompte d’occurence avec la fonction <code>n()</code> ou <code>count()</code></li>
</ul>
<p>Par exemple,</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1"><span class="kw">mean</span>(chicoute<span class="op">$</span>Rendement_g_5m2, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] 13.32851</code></pre>
<p><strong>En mode classique</strong>, pour effectuer des opérations sur des tableaux, on utilisera la fonction <code>apply()</code>. Cette fonction prend, comme arguments, le tableau, l’axe (opération par ligne = 1, opération par colonne = 2), puis la fonction à appliquer.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1"><span class="kw">apply</span>(chicoute <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;pourc&quot;</span>)), <span class="dv">2</span>, mean)</a></code></pre></div>
<pre><code>##      C_pourc      N_pourc      P_pourc      K_pourc     Ca_pourc 
## 5.027911e+01 2.199411e+00 1.388959e-01 8.887000e-01 3.884391e-01 
##     Mg_pourc      S_pourc      B_pourc     Cu_pourc     Zn_pourc 
## 4.980142e-01 1.347177e-01 3.090922e-03 4.089891e-04 6.662155e-03 
##     Mn_pourc     Fe_pourc     Al_pourc 
## 3.345239e-02 1.514885e-02 2.694979e-03</code></pre>
<p>Les opération peuvent aussi être effectuées par ligne, par exemple une somme (je garde seulement les 10 premiers résultats).</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1"><span class="kw">apply</span>(chicoute <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;pourc&quot;</span>)), <span class="dv">1</span>, sum)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a></code></pre></div>
<pre><code>##  [1] 55.64299 55.76767 54.78856 55.84453 57.89671 55.53603 55.62526
##  [8] 55.10991 55.06295 55.16774</code></pre>
<p>La fonction à appliquer peut être personnalisée, par exemple:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1"><span class="kw">apply</span>(chicoute <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;pourc&quot;</span>)), <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb210-2" data-line-number="2">      <span class="cf">function</span>(x) (<span class="kw">prod</span>(x))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">length</span>(x)))</a></code></pre></div>
<pre><code>##      C_pourc      N_pourc      P_pourc      K_pourc     Ca_pourc 
## 50.253429104  2.165246915  0.133754530  0.846193827  0.376192724 
##     Mg_pourc      S_pourc      B_pourc     Cu_pourc     Zn_pourc 
##  0.491763884  0.129900753  0.003014675  0.000000000  0.006408775 
##     Mn_pourc     Fe_pourc     Al_pourc 
##  0.024140327  0.014351745  0.002450982</code></pre>
<p>Vous reconnaissez cette fonction? C’était la moyenne géométrique (la fonction <code>prod()</code> étant le produit d’un vecteur).</p>
<p><strong>En mode tidyverse</strong>, on aura besoin principalement des fonction suivantes:</p>
<ul>
<li><code>group_by()</code> pour effectuer des opérations par groupe, l’oprération <code>group_by()</code> sépare le tableau en plusieurs petits tableaux, en attendant de les recombiner. C’est un peu l’équivalent des facettes en ggplot2…</li>
<li><code>summarise()</code> pour réduire plusieurs valeurs en une seule, il applique un calcul sur le tableau ou s’il y a lieu sur chaque petit tableau segmenté. Il en existe quelques variantes.
<ul>
<li><code>summarise_all()</code> applique la fonction à toutes les colonnes</li>
<li><code>summarise_at()</code> applique la fonction aux colonnes spécifiées</li>
<li><code>summarise_if()</code> applique la fonction aux colonnes qui resortent comme <code>TRUE</code> selon une opération booléenne</li>
</ul></li>
<li><code>mutate()</code> pour ajotuer une nouvelle colonne
<ul>
<li>Si l’on désire ajouter une colonne à un tableau, par exemple le sommaire calculé avec <code>summarise()</code>. À l’inverse, la fonction <code>transmute()</code> retournera seulement le résultat, sans le tableau à partir duquel il a été calculé. De même que <code>summarise()</code>, <code>mutate()</code> et <code>transmute()</code> possèdent leurs équivalents <code>_all()</code>, <code>_at()</code> et <code>_if()</code>.</li>
</ul></li>
<li><code>arrange()</code> pour réordonner le tableau
<ul>
<li>On a déjà couvert <code>arrange()</code> dans le chapitre 3. Rappelons que cette fonction n’est pas une opération sur un tableau, mais plutôt un changement d’affichage en changeant l’ordre d’apparition des données.</li>
</ul></li>
</ul>
<p>Ces opérations sont décrites dans l’aide-mémoire <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf"><em>Data Transformation Cheat Sheet</em></a>.</p>
<p><a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf"><img src="https://www.rstudio.com/wp-content/uploads/2015/01/data-transformation-cheatsheet-600x464.png" /></a></p>
<p>Aide-mémoire de dplyr, source: <a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a></p>
<p>Pour effectuer des statistiques par colonne, on utilisera <code>summarise_all()</code> étant donnée que l’on désire un sommaire sur toutes les variables sélectionnées. Pour spécifier que l’on désire la moyenne et l’écart-type on inscrit les noms des fonctions dans <code>funs()</code>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb212-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;pourc&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb212-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(mean, sd))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 26
##   C_pourc_mean N_pourc_mean P_pourc_mean K_pourc_mean Ca_pourc_mean
##          &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
## 1         50.3         2.20        0.139        0.889         0.388
## # ... with 21 more variables: Mg_pourc_mean &lt;dbl&gt;, S_pourc_mean &lt;dbl&gt;,
## #   B_pourc_mean &lt;dbl&gt;, Cu_pourc_mean &lt;dbl&gt;, Zn_pourc_mean &lt;dbl&gt;,
## #   Mn_pourc_mean &lt;dbl&gt;, Fe_pourc_mean &lt;dbl&gt;, Al_pourc_mean &lt;dbl&gt;,
## #   C_pourc_sd &lt;dbl&gt;, N_pourc_sd &lt;dbl&gt;, P_pourc_sd &lt;dbl&gt;,
## #   K_pourc_sd &lt;dbl&gt;, Ca_pourc_sd &lt;dbl&gt;, Mg_pourc_sd &lt;dbl&gt;,
## #   S_pourc_sd &lt;dbl&gt;, B_pourc_sd &lt;dbl&gt;, Cu_pourc_sd &lt;dbl&gt;,
## #   Zn_pourc_sd &lt;dbl&gt;, Mn_pourc_sd &lt;dbl&gt;, Fe_pourc_sd &lt;dbl&gt;,
## #   Al_pourc_sd &lt;dbl&gt;</code></pre>
<p>On utilisera <code>group_by()</code> pour segmenter le tableau, et ainsi obtenir des statistiques pour chaque groupe.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb214-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(CodeTourbiere) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb214-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;pourc&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb214-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(mean, sd))</a></code></pre></div>
<pre><code>## Adding missing grouping variables: `CodeTourbiere`</code></pre>
<pre><code>## # A tibble: 12 x 27
##    CodeTourbiere C_pourc_mean N_pourc_mean P_pourc_mean K_pourc_mean
##    &lt;chr&gt;                &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
##  1 1                     50.7         2.26       0.156         0.880
##  2 2                     49.2         2.76       0.181         1.12 
##  3 BEAU                  51.7         2.00       0.0967        1.12 
##  4 BP                    51.2         2.05       0.158         0.747
##  5 BS2                   52.5         2.08       0.103         1.12 
##  6 MB                    51.5         2.15       0.109         0.675
##  7 MR                    50.6         1.99       0.127         0.830
##  8 NBM                   51.6         2.01       0.127         0.854
##  9 NESP                  48.3         1.76       0.135         0.945
## 10 NTP                   51.3         1.83       0.0873        0.402
## 11 SSP                   48.7         1.83       0.130         0.700
## 12 WTP                   47.8         1.79       0.0811        0.578
## # ... with 22 more variables: Ca_pourc_mean &lt;dbl&gt;, Mg_pourc_mean &lt;dbl&gt;,
## #   S_pourc_mean &lt;dbl&gt;, B_pourc_mean &lt;dbl&gt;, Cu_pourc_mean &lt;dbl&gt;,
## #   Zn_pourc_mean &lt;dbl&gt;, Mn_pourc_mean &lt;dbl&gt;, Fe_pourc_mean &lt;dbl&gt;,
## #   Al_pourc_mean &lt;dbl&gt;, C_pourc_sd &lt;dbl&gt;, N_pourc_sd &lt;dbl&gt;,
## #   P_pourc_sd &lt;dbl&gt;, K_pourc_sd &lt;dbl&gt;, Ca_pourc_sd &lt;dbl&gt;,
## #   Mg_pourc_sd &lt;dbl&gt;, S_pourc_sd &lt;dbl&gt;, B_pourc_sd &lt;dbl&gt;,
## #   Cu_pourc_sd &lt;dbl&gt;, Zn_pourc_sd &lt;dbl&gt;, Mn_pourc_sd &lt;dbl&gt;,
## #   Fe_pourc_sd &lt;dbl&gt;, Al_pourc_sd &lt;dbl&gt;</code></pre>
<p>Pour obtenir des statistiques à chaque ligne, mieux vaut utiliser <code>apply()</code>, tel que vu précédemment. Le point, <code>.</code>, représente le tableau dans la fonction.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb217-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;pourc&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb217-3" data-line-number="3"><span class="st">  </span><span class="kw">apply</span>(., <span class="dv">1</span>, sum)</a></code></pre></div>
<pre><code>##  [1] 55.64299 55.76767 54.78856 55.84453 57.89671 55.53603 55.62526
##  [8] 55.10991 55.06295 55.16774 56.41123 55.47917 55.43537 55.79175
## [15] 55.44561 54.85448 54.34262 55.03075 54.40533 51.89319 54.70172
## [22] 54.62176 54.30250 53.86976 53.44731 53.86244 52.43280 54.34978
## [29] 53.96756 51.46672 55.44267 54.70350 55.30711 56.16200 56.64710
## [36] 55.95499 54.76370 54.32775 54.95419 53.37094 53.07855 53.04541
## [43] 52.09520 52.40456 51.92376 53.33248 56.56405 56.35004 56.27185
## [50] 55.56986 53.81654 55.39638 55.51961 54.88098 54.74774 51.08921
## [57] 51.31462 53.46819 53.15640 52.82020 57.78038 57.94636 56.65558
## [64] 56.28845 55.54463 56.51751 55.36497 56.00594 55.64247 56.56967
## [71] 56.81674 55.87070 55.72308 56.14116 56.42611 55.35650 54.90469
## [78] 54.03674 53.42991 53.99334 53.09085 53.23222 53.28212 53.63192
## [85] 53.48102 52.31131 51.72026 51.10534 51.49055 51.59297</code></pre>
<p>Revenons à notre tableau des especes meancées.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1">especes_menacees &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;data/WILD_LIFE_16082018051732754.csv&#39;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   IUCN = col_character(),
##   `IUCN Category` = col_character(),
##   SPEC = col_character(),
##   Species = col_character(),
##   COU = col_character(),
##   Country = col_character(),
##   `Unit Code` = col_character(),
##   Unit = col_character(),
##   `PowerCode Code` = col_double(),
##   PowerCode = col_character(),
##   `Reference Period Code` = col_logical(),
##   `Reference Period` = col_logical(),
##   Value = col_double(),
##   `Flag Codes` = col_logical(),
##   Flags = col_logical()
## )</code></pre>
<p>Nous avions exécuté le pipeline suivant.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1">especes_menacees <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb221-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(IUCN <span class="op">==</span><span class="st"> &#39;CRITICAL&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb221-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(Country, Value) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb221-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(Country)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb221-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_critical_species =</span> <span class="kw">sum</span>(Value)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb221-6" data-line-number="6"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n_critical_species)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb221-7" data-line-number="7"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## Selecting by n_critical_species</code></pre>
<pre><code>## # A tibble: 10 x 2
##    Country         n_critical_species
##    &lt;chr&gt;                        &lt;dbl&gt;
##  1 Czech Republic                2159
##  2 United States                 1409
##  3 Germany                        915
##  4 Japan                          628
##  5 Austria                        618
##  6 Slovak Republic                602
##  7 Canada                         522
##  8 Poland                         485
##  9 Switzerland                    483
## 10 Brazil                         453</code></pre>
<p>Ce pipeline consistait à:</p>
<pre><code>prendre le tableau especes_menacees, puis
  filtrer pour n&#39;obtenir que les espèces critiques, puis
  sélectionner les colonnes des pays et des valeurs (nombre d&#39;espèces), puis
  segmenter le tableaux en plusieurs tableaux selon le pays, puis
  appliquer la fonction sum pour chacun de ces petits tableaux (puis de recombiner ces sommaires), puis
  trier les pays en nombre décroissant de décompte d&#39;espèces, puis
  afficher le top 10</code></pre>
</div>
<div id="exemple-difficile" class="section level2">
<h2><span class="header-section-number">35.6</span> Exemple (difficile)</h2>
<p>Pour revenir à notre tableau <code>chicoute</code>, imaginez que vous aviez une station météo (station_A) située aux coordonnées (490640, 5702453) et que vous désiriez calculer la distance entre l’observation et la station. Prenez du temps pour réfléchir à la manière dont vous procéderez…</p>
<p>On pourra créer une fonction qui mesure la distance entre un point x, y et les coordonnées de la station A…</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1">dist_station_A &lt;-<span class="st"> </span><span class="cf">function</span> (x, y) {</a>
<a class="sourceLine" id="cb225-2" data-line-number="2">  <span class="kw">return</span>(<span class="kw">sqrt</span>((x <span class="op">-</span><span class="st"> </span><span class="dv">490640</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(y <span class="op">-</span><span class="st"> </span><span class="dv">5702453</span>)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb225-3" data-line-number="3">}</a></code></pre></div>
<p>… puis ajouter une colonne avec mutate grâce à une fonction prenant les arguments x et y spécifiés.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb226-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dist =</span> <span class="kw">dist_station_A</span>(<span class="dt">x =</span> Longitude_m, <span class="dt">y=</span> Latitude_m)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb226-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(ID, CodeTourbiere, Longitude_m, Latitude_m, dist) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb226-4" data-line-number="4"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## Selecting by dist</code></pre>
<pre><code>## # A tibble: 10 x 5
##       ID CodeTourbiere Longitude_m Latitude_m   dist
##    &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;
##  1     7 BP                 484054    5706307  7631.
##  2    36 MR                 459875    5701988 30769.
##  3    37 MR                 459873    5701987 30771.
##  4    38 MR                 459880    5701971 30764.
##  5    39 MR                 459894    5701966 30750.
##  6    40 MR                 459915    5701994 30728.
##  7    46 NBM                485975    5695688  8218.
##  8    48 NBM                485912    5696607  7519.
##  9    49 NBM                485903    5696611  7521.
## 10    50 NBM                485884    5696612  7532.</code></pre>
<p>Nous pourrions procéder de la même manière pour fusionner des données climatiques. Le tableau <code>chicoute</code> ne possède pas d’indicateurs climatiques, mais il est possible de les soutirer de stations météos placées près des site. Ces données ne sont pas disponibles pour le tableau de la chicouté, alors j’utiliserai des données fictives pour l’exemple.</p>
<p>Voici ce qui pourrait être fait.</p>
<ol style="list-style-type: decimal">
<li>Créer un tableau des stations météo ainsi que des indices météo associés à ces stations.</li>
<li>Lier chaque site à une station (à la main où selon la plus petite distance entre le site et la station).</li>
<li>Fusionner les inices climatiques aux sites, puis les sites aux mesures de rendement.</li>
</ol>
<p>Ces opérations demandent habituellement du tâtonnement. Il serait surprenant que même une personne expérimentée soit en mesure de compiler ces opérations sans obtenir de message d’erreur, et retravailler jusqu’à obtenir le résultat souhaité. L’objectif de cette section est de vous présenté un flux de travail que vous pourriez être amenés à effectuer et de fournir quelques éléments nouveau pour mener à bien une opération. Il peut être frustant de ne pas saisir toutes les opérations: passez à travers cette section sans jugement. Si vous devez vous frotter à problème semblable, vous saurez que vous trouverez dans ce manuel une recette intéressante.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1">stations &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Station =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>),</a>
<a class="sourceLine" id="cb229-2" data-line-number="2">                       <span class="dt">Longitude_m =</span> <span class="kw">c</span>(<span class="dv">490640</span>, <span class="dv">484870</span>, <span class="dv">485929</span>),</a>
<a class="sourceLine" id="cb229-3" data-line-number="3">                       <span class="dt">Latitude_m =</span> <span class="kw">c</span>(<span class="dv">5702453</span>, <span class="dv">5701870</span>, <span class="dv">5696421</span>), </a>
<a class="sourceLine" id="cb229-4" data-line-number="4">                       <span class="dt">t_moy_C =</span> <span class="kw">c</span>(<span class="fl">13.8</span>, <span class="fl">18.2</span>, <span class="fl">16.30</span>),</a>
<a class="sourceLine" id="cb229-5" data-line-number="5">                       <span class="dt">prec_tot_mm =</span> <span class="kw">c</span>(<span class="dv">687</span>, <span class="dv">714</span>, <span class="dv">732</span>))</a>
<a class="sourceLine" id="cb229-6" data-line-number="6">stations</a></code></pre></div>
<pre><code>##   Station Longitude_m Latitude_m t_moy_C prec_tot_mm
## 1       A      490640    5702453    13.8         687
## 2       B      484870    5701870    18.2         714
## 3       C      485929    5696421    16.3         732</code></pre>
<p>La fonction suivante calcule la distance entre des coordonnées x et y et chaque station d’un tableau de stations, puis retourne le nom de la station dont la distance est la moindre.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1">dist_station &lt;-<span class="st"> </span><span class="cf">function</span> (x, y, stations_df) {</a>
<a class="sourceLine" id="cb231-2" data-line-number="2">    <span class="co"># stations est le tableau des stations à trois colonnes</span></a>
<a class="sourceLine" id="cb231-3" data-line-number="3">    <span class="co"># 1iere: nom de la station</span></a>
<a class="sourceLine" id="cb231-4" data-line-number="4">    <span class="co"># 2ieme: longitude</span></a>
<a class="sourceLine" id="cb231-5" data-line-number="5">    <span class="co"># 3ieme: latitude</span></a>
<a class="sourceLine" id="cb231-6" data-line-number="6">    distance &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb231-7" data-line-number="7">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(stations)) {</a>
<a class="sourceLine" id="cb231-8" data-line-number="8">        distance[i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>((x <span class="op">-</span><span class="st"> </span>stations[i, <span class="dv">2</span>])<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(y <span class="op">-</span><span class="st"> </span>stations[i, <span class="dv">3</span>])<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb231-9" data-line-number="9">    }</a>
<a class="sourceLine" id="cb231-10" data-line-number="10">    nom_station &lt;-<span class="st"> </span><span class="kw">as.character</span>(stations<span class="op">$</span>Station[<span class="kw">which.min</span>(distance)])</a>
<a class="sourceLine" id="cb231-11" data-line-number="11">    <span class="kw">return</span>(nom_station)</a>
<a class="sourceLine" id="cb231-12" data-line-number="12">}</a></code></pre></div>
<p>Testons la fonction avec des coordonnées.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" data-line-number="1"><span class="kw">dist_station</span>(<span class="dt">x =</span> <span class="dv">459875</span>, <span class="dt">y =</span> <span class="dv">5701988</span>, <span class="dt">stations_df =</span> stations)</a></code></pre></div>
<pre><code>## [1] &quot;B&quot;</code></pre>
<p>Nous appliquons cette fonction à toutes les lignes du tableau, puis en retournons un échantillon.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1">chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-2" data-line-number="2"><span class="st">    </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Station =</span> <span class="kw">dist_station</span>(<span class="dt">x =</span> Longitude_m, <span class="dt">y =</span> Latitude_m, <span class="dt">stations_df =</span> stations)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-4" data-line-number="4"><span class="st">    </span><span class="kw">select</span>(ID, CodeTourbiere, Longitude_m, Latitude_m, Station) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb234-5" data-line-number="5"><span class="st">    </span><span class="kw">sample_n</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##       ID CodeTourbiere Longitude_m Latitude_m Station
##    &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt; &lt;chr&gt;  
##  1    86 WTP                487075    5700788 B      
##  2    81 1                  486504    5702081 B      
##  3    17 2                  486501    5702627 B      
##  4    45 NESP               484875    5701861 B      
##  5    48 NBM                485912    5696607 C      
##  6     1 BEAU               490627    5702454 A      
##  7    29 2                  486350    5702494 B      
##  8    87 WTP                487064    5700776 B      
##  9    85 1                  486514    5702160 B      
## 10    59 SSP                484454    5699796 B</code></pre>
<p>Cela semble fonctionner. On peut y ajouter un <code>left_join()</code> pour joindre les données météo au tableau principal.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" data-line-number="1">chicoute_weather &lt;-<span class="st"> </span>chicoute <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb236-2" data-line-number="2"><span class="st">    </span><span class="kw">rowwise</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb236-3" data-line-number="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Station =</span> <span class="kw">dist_station</span>(<span class="dt">x =</span> Longitude_m, <span class="dt">y =</span> Latitude_m, <span class="dt">stations_df =</span> stations)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb236-4" data-line-number="4"><span class="st">    </span><span class="kw">left_join</span>(<span class="dt">y =</span> stations, <span class="dt">by =</span> <span class="st">&quot;Station&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Column `Station` joining character vector and factor, coercing
## into character vector</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" data-line-number="1">chicoute_weather <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>)</a></code></pre></div>
<pre><code>## # A tibble: 10 x 36
##       ID CodeTourbiere Ordre  Site Traitement DemiParcelle SousTraitement
##    &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;chr&gt;         
##  1     5 BEAU          A         5 &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;          
##  2    65 BS2           G         5 &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;          
##  3    28 2             10       19 fertilisa~ right        B             
##  4    76 1             3         6 temoin     left         B             
##  5    36 MR            I         1 &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;          
##  6    50 NBM           D         5 &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;          
##  7    26 2             9        18 temoin     right        B             
##  8    16 2             7        13 fertilisa~ right        B             
##  9    49 NBM           D         4 &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;          
## 10    10 BP            H         5 &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;          
## # ... with 29 more variables: Latitude_m.x &lt;dbl&gt;, Longitude_m.x &lt;dbl&gt;,
## #   Rendement_g_5m2 &lt;dbl&gt;, TotalRamet_nombre_m2 &lt;dbl&gt;,
## #   TotalVegetatif_nombre_m2 &lt;dbl&gt;, TotalFloral_nombre_m2 &lt;dbl&gt;,
## #   TotalMale_nombre_m2 &lt;dbl&gt;, TotalFemelle_nombre_m2 &lt;dbl&gt;,
## #   FemelleFruit_nombre_m2 &lt;dbl&gt;, FemelleAvorte_nombre_m2 &lt;dbl&gt;,
## #   SterileFleur_nombre_m2 &lt;dbl&gt;, C_pourc &lt;dbl&gt;, N_pourc &lt;dbl&gt;,
## #   P_pourc &lt;dbl&gt;, K_pourc &lt;dbl&gt;, Ca_pourc &lt;dbl&gt;, Mg_pourc &lt;dbl&gt;,
## #   S_pourc &lt;dbl&gt;, B_pourc &lt;dbl&gt;, Cu_pourc &lt;dbl&gt;, Zn_pourc &lt;dbl&gt;,
## #   Mn_pourc &lt;dbl&gt;, Fe_pourc &lt;dbl&gt;, Al_pourc &lt;dbl&gt;, Station &lt;chr&gt;,
## #   Longitude_m.y &lt;dbl&gt;, Latitude_m.y &lt;dbl&gt;, t_moy_C &lt;dbl&gt;,
## #   prec_tot_mm &lt;dbl&gt;</code></pre>
</div>
<div id="exporter-un-tableau" class="section level2">
<h2><span class="header-section-number">35.7</span> Exporter un tableau</h2>
<p>Simplement avec <code>write_csv()</code>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" data-line-number="1"><span class="kw">write_csv</span>(chicoute_weather, <span class="st">&quot;data/chicoute_weather.csv&quot;</span>)</a></code></pre></div>
</div>
<div id="aller-plus-loin-dans-le-tidyverse" class="section level2">
<h2><span class="header-section-number">35.8</span> Aller plus loin dans le tidyverse</h2>
<p>Le livre <a href="http://r4ds.had.co.nz">R for Data Science</a>, de Garrett Grolemund et Hadley Wickham, est un incontournable.</p>
<p><a href="http://r4ds.had.co.nz"><img src="http://r4ds.had.co.nz/cover.png" width=200></a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="entreposer-ses-donnees.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
